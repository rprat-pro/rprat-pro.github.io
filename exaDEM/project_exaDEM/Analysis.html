<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>10. I/O and Analysis &mdash; ExaDEM &amp; ExaNBody  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11. Parallelization" href="Parallelization.html" />
    <link rel="prev" title="9. Drivers" href="Drivers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ExaDEM & ExaNBody
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">ExaNB Framework</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html">1. ExaNBody: Framework for N-Body Simulations on HPC Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html#installing-exanb">2. Installing ExaNB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html#n-body-background">3. N-Body Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html#software-stack-of-exanbody">4. Software stack of ExaNBody</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html#performance-and-portability">5. Performance and portability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html#algorithm-patterns">6. Algorithm Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html#list-of-plugins">7. List of Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html#exanbody-command-lines">8. ExaNBody Command Lines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html#tutorials">9. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html#exanbody-publications">10. ExaNBody Publications:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/index.html#example-for-rst-usage-math-code-etc">11. Example for rst usage (math, code etc)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ExDEM Variant</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">1. ExaDEM Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Test_cases.html">3. Test cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="Polyhedra.html">4. Polyhedron</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spheres.html">5. Spheres</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fields.html">6. Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="ForceField.html">7. Force Field</a></li>
<li class="toctree-l1"><a class="reference internal" href="NumericalScheme.html">8. Numerical Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="Drivers.html">9. Drivers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">10. I/O and Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#reader-operators">10.1. Reader Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reader-of-xyz-file">10.1.1. Reader Of xyz File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reader-of-mpiio-file">10.1.2. Reader Of MPIIO File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#writer-operators">10.2. Writer Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#writer-of-mpiio-files">10.2.1. Writer Of MPIIO Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writer-of-xyz-files">10.2.2. Writer Of XYZ Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#polyedra-i-o-and-analysis">10.3. Polyedra I/O and Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#read-shape-file">10.3.1. Read Shape File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dump-paraview-for-polyhedra">10.3.2. Dump Paraview For Polyhedra</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dump-contact-network">10.3.3. Dump Contact Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dump-interaction-data">10.3.4. Dump Interaction Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interaction-summary">10.3.5. Interaction Summary</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Parallelization.html">11. Parallelization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial.html">12. Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using exaNBody applications on Adastra</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/adastra.html">1. Installing ExaNB and Your application on Adastra</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../project_exaNBody/bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ExaDEM & ExaNBody</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">10. </span>I/O and Analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/project_exaDEM/Analysis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="i-o-and-analysis">
<h1><span class="section-number">10. </span>I/O and Analysis<a class="headerlink" href="#i-o-and-analysis" title="Permalink to this heading"></a></h1>
<p>In this section, we will describe the various operators used for analysis and I/O in DEM simulations.</p>
<section id="reader-operators">
<h2><span class="section-number">10.1. </span>Reader Operators<a class="headerlink" href="#reader-operators" title="Permalink to this heading"></a></h2>
<section id="reader-of-xyz-file">
<h3><span class="section-number">10.1.1. </span>Reader Of xyz File<a class="headerlink" href="#reader-of-xyz-file" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Name: <cite>read_xyz</cite></p></li>
<li><p>Description: This operator reads a file written according to the xyz format.</p></li>
<li><dl class="simple">
<dt>Parameters:</dt><dd><ul>
<li><p><cite>bounds_mode</cite> : default mode corresponde to ReadBoundsSelectionMode.</p></li>
<li><p><cite>enlarge_bounds</cite> : Define a layer around the volume size in the xyz file. Default size is 0.</p></li>
<li><p><cite>file</cite> : File name, this parameter is required.</p></li>
<li><p><cite>pbc_adjust_xform</cite> : Ajust the form.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>YAML example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">read_xyz</span><span class="p">:</span>
<span class="w">  </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">input_file_rigid_surface.xyz</span>
<span class="w">  </span><span class="nt">bounds_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FILE</span>
<span class="w">  </span><span class="nt">enlarge_bounds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0 m</span>
</pre></div>
</div>
<p>How to build your xyz input file of <cite>nb</cite> particles.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nb</span>
<span class="n">box_size_x</span> <span class="n">box_size_y</span> <span class="n">box_size_z</span>
<span class="n">type_0</span> <span class="n">pos_x_0</span> <span class="n">pos_y_0</span> <span class="n">pos_z_0</span>
<span class="n">type_1</span> <span class="n">pos_x_1</span> <span class="n">pos_y_1</span> <span class="n">pos_z_1</span>
<span class="n">type_2</span> <span class="n">pos_x_2</span> <span class="n">pos_y_2</span> <span class="n">pos_z_2</span>
<span class="o">...</span>
<span class="n">type_nb</span><span class="o">-</span><span class="mi">1</span> <span class="n">pos_x_nb</span><span class="o">-</span><span class="mi">1</span> <span class="n">pos_y_nb</span><span class="o">-</span><span class="mi">1</span> <span class="n">pos_z_nb</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>This is an example of two particles the same type in a domain [[0,0,0],[10,10,10]].</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">0</span> <span class="mf">2.5</span> <span class="mf">5.0</span> <span class="mf">5.0</span>
<span class="mi">0</span> <span class="mf">7.5</span> <span class="mf">5.0</span> <span class="mf">5.0</span>
</pre></div>
</div>
</section>
<section id="reader-of-mpiio-file">
<h3><span class="section-number">10.1.2. </span>Reader Of MPIIO File<a class="headerlink" href="#reader-of-mpiio-file" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Name: <cite>read_dump_particles</cite></p></li>
<li><p>Description: This operator readz a dump file with all particles information required to restart the simulation. See operator : &#64;write_dump_particles</p></li>
<li><dl class="simple">
<dt>Parameters:</dt><dd><ul>
<li><p><cite>enable_friction</cite> : Enable to write friction information. By default this option is activated.</p></li>
<li><p><cite>filename</cite> : Dump file name to read.</p></li>
<li><p><cite>bounds</cite> : If set, override domain’s bounds, filtering out particle outside of overriden bounds (AABB = [[infx, infy, infz],[supx, supy, supz]]).</p></li>
<li><p><cite>expandable</cite> : If set, override domain expandability stored in file</p></li>
<li><p><cite>periodicity</cite> : If set, overrides domain’s periodicity stored in file with this value (ex: [false,true,false]).</p></li>
<li><p><cite>scale_cell_size</cite> : If set, this opetion rescale cell size. Due to friction storage per cell, ou can only multiply this size by an integer (1,2,4, 8, …) or divide it by a power of 1/(2^n) (0.5,0.25 …).</p></li>
<li><p><cite>shrink_to_fit</cite> : If set to true and bounds was wpecified, try to reduce domain’s grid size to the minimum size enclosing fixed bounds.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>YAML example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">read_dump_particles</span><span class="p">:</span>
<span class="w">    </span><span class="nt">filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">last.dump</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operator is used for spheres and not polyhedra because we need a special reader to read current interactions values containing the friction and moment. Show <cite>read_dump_particle_interaction</cite>.</p>
</div>
</section>
</section>
<section id="writer-operators">
<h2><span class="section-number">10.2. </span>Writer Operators<a class="headerlink" href="#writer-operators" title="Permalink to this heading"></a></h2>
<section id="writer-of-mpiio-files">
<h3><span class="section-number">10.2.1. </span>Writer Of MPIIO Files<a class="headerlink" href="#writer-of-mpiio-files" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Name: <cite>write_dump_particles</cite></p></li>
<li><p>Description: This operator writes a dump file with all particles information required to restart the simulation. See operator : &#64;read_dump_particles.</p></li>
<li><dl class="simple">
<dt>Parameters:</dt><dd><ul>
<li><p><cite>compression_level</cite> Zlib compression level.</p></li>
<li><p><cite>filename</cite> Dump output file name.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Default behaviour: the default name is defined by : <cite>- timestep_file: “exaDEM_%09d.dump</cite> and piloted by <cite>simulation_dump_frequency: 1</cite> in the operator <cite>global</cite>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operator is defined in the default <cite>ExaDEM</cite> operator named <cite>dump_data_particles</cite>.</p>
</div>
</section>
<section id="writer-of-xyz-files">
<h3><span class="section-number">10.2.2. </span>Writer Of XYZ Files<a class="headerlink" href="#writer-of-xyz-files" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Name: <cite>write_xyz_generic</cite></p></li>
<li><p>Description: This operator writes a txt file (<cite>.xyz</cite>) with all specified fields.</p></li>
<li><p>Parameters:
* <cite>fields</cite>: array of fieldsets. Example: <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">id,</span> <span class="pre">velocity,</span> <span class="pre">radius</span> <span class="pre">]</span></code>
* <cite>filename</cite>: name of the output file.
* <cite>units</cite>: array of units. Example: <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">velocity:</span> <span class="pre">&quot;m/s&quot;,</span> <span class="pre">radius:</span> <span class="pre">&quot;m&quot;</span> <span class="pre">}</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first line of the output file contains the number of particles. The second line contains the “lattice” description, useful when using ovito.</p>
</div>
<p>YAML example: Replaces MPIIO Output files with xyz files.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dump_data_xyz</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">timestep_file</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dem_pos_vel_%09d.xyz&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">write_xyz_generic</span><span class="p">:</span>
<span class="w">     </span><span class="nt">fields</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">id</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">velocity</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">radius</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">units</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt"> velocity</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;m/s&quot;</span><span class="p p-Indicator">,</span><span class="nt"> radius</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;m&quot;</span><span class="w"> </span><span class="p p-Indicator">}</span>

<span class="nt">iteration_dump_writer</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dump_data_xyz</span>

<span class="nt">global</span><span class="p">:</span>
<span class="w">  </span><span class="nt">simulation_dump_frequency</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
</pre></div>
</div>
<p>To process these files, a sample script is provided in <code class="docutils literal notranslate"><span class="pre">scripts/post_processing/profile_pos_vel.py</span></code>. This is a minimal, easily modifiable post-processing file, that calculates the averages of all position and velocity components.</p>
<p>Output file: [mean_r_v.pdf]</p>
<p><a class="reference internal" href="../_images/mean_r_v.png"><img alt="anmean" src="../_images/mean_r_v.png" style="width: 500pt;" /></a></p>
</section>
</section>
<section id="polyedra-i-o-and-analysis">
<h2><span class="section-number">10.3. </span>Polyedra I/O and Analysis<a class="headerlink" href="#polyedra-i-o-and-analysis" title="Permalink to this heading"></a></h2>
<p>In this section, we will describe the operators related to the usage of polyhedra.</p>
<section id="read-shape-file">
<h3><span class="section-number">10.3.1. </span>Read Shape File<a class="headerlink" href="#read-shape-file" title="Permalink to this heading"></a></h3>
<p>The purpose of this operator is to add shapes to a collection of shapes. This operator can be called as many times as desired. However, if you add the same shape multiple times, it will create duplicates. Additionally, the shapes will be ordered according to the order of reading, meaning that type 0 will be associated with the first shape from the first input file. Furthermore, this operator will automatically create a polydata for each shape, which will be used for displaying the polyhedra using ParaView.</p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>read_shape_file</cite> :</dt><dd><ul>
<li><p><cite>filename</cite>: Input file name, no default name.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Warnings:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>This operator takes on ASCII files.</p></li>
<li><p>This operator is not typo-proof and will ignore problematic values.</p></li>
<li><p>Do not define a shape “driven” such as a wall or a cylinder because the cell diameters and the cutoff radius for creating interaction lists are derived from the shapes of the polyhedra. These should be defined in specific operators if they have an analytical shape. If they have particular shapes with many facets, please use the STL mesh reader.</p></li>
</ul>
</div>
<p>YAML example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">read_shape_file</span><span class="p">:</span>
<span class="w">   </span><span class="nt">filename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shapes.shp</span>
</pre></div>
</div>
<p>Example of a shape:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span>
<span class="n">name</span> <span class="n">Octahedron</span>
<span class="n">radius</span> <span class="mf">0.1</span>
<span class="n">preCompDone</span> <span class="n">y</span>
<span class="n">nv</span> <span class="mi">6</span>
<span class="mf">0.2310789034541148</span> <span class="o">-</span><span class="mf">0.2310789034541148</span> <span class="mf">0.0</span>
<span class="mf">0.2310789034541148</span> <span class="mf">0.2310789034541148</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.32679491924311227</span>
<span class="o">-</span><span class="mf">0.2310789034541148</span> <span class="o">-</span><span class="mf">0.2310789034541148</span> <span class="mf">0.0</span>
<span class="o">-</span><span class="mf">0.2310789034541148</span> <span class="mf">0.2310789034541148</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">0.0</span> <span class="o">-</span><span class="mf">0.32679491924311227</span>
<span class="n">ne</span> <span class="mi">12</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">3</span>
<span class="mi">2</span> <span class="mi">3</span>
<span class="mi">3</span> <span class="mi">4</span>
<span class="mi">4</span> <span class="mi">2</span>
<span class="mi">4</span> <span class="mi">1</span>
<span class="mi">5</span> <span class="mi">0</span>
<span class="mi">5</span> <span class="mi">1</span>
<span class="mi">5</span> <span class="mi">4</span>
<span class="mi">5</span> <span class="mi">3</span>
<span class="n">nf</span> <span class="mi">8</span>
<span class="mi">3</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span>
<span class="mi">3</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span>
<span class="mi">3</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span>
<span class="mi">3</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">3</span> <span class="mi">0</span> <span class="mi">5</span> <span class="mi">1</span>
<span class="mi">3</span> <span class="mi">0</span> <span class="mi">5</span> <span class="mi">3</span>
<span class="mi">3</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">4</span>
<span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">1</span>
<span class="n">obb</span><span class="o">.</span><span class="n">extent</span> <span class="mf">0.33107890345411484</span> <span class="mf">0.33107890345411484</span> <span class="mf">0.4267949192431123</span>
<span class="n">obb</span><span class="o">.</span><span class="n">e1</span> <span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">obb</span><span class="o">.</span><span class="n">e2</span> <span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">0.0</span>
<span class="n">obb</span><span class="o">.</span><span class="n">e3</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span>
<span class="n">obb</span><span class="o">.</span><span class="n">center</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">position</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">orientation</span> <span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">volume</span> <span class="mf">0.16666666666666666</span>
<span class="n">I</span><span class="o">/</span><span class="n">m</span> <span class="mf">0.04999999999999999</span> <span class="mf">0.04999999999999999</span> <span class="mf">0.04999999999999999</span>
<span class="o">&gt;</span>
</pre></div>
</div>
<p>Example of <cite>Octahedron.vtk</cite> with paraview:</p>
<a class="reference internal image-reference" href="../_images/octahedron.png"><img alt="../_images/octahedron.png" src="../_images/octahedron.png" style="width: 300pt;" /></a>
</section>
<section id="dump-paraview-for-polyhedra">
<h3><span class="section-number">10.3.2. </span>Dump Paraview For Polyhedra<a class="headerlink" href="#dump-paraview-for-polyhedra" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>In exaDEM, there are two ways to display polyhedra with Paraview:</dt><dd><ul class="simple">
<li><p>The first is to directly display the vertices of the polyhedra and the surfaces in parallel VTP (PolyData). However, no fields associated with the polyhedra are available, such as velocity or density.</p></li>
<li><p>The second solution is to use the generic Paraview output of <cite>exaDEM</cite> by adding the orientation field and the homethety field (optional). Then, it’s possible to associate a mesh with each point, such as an <cite>octahedron.vtk</cite> file generated by <cite>read_shape_file</cite>, to each point by associating it with a size (<cite>field::homothety</cite>) and a quaternion (<cite>field::orient</cite>).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only the default behavior when the <cite>config_polyhedra.msp file</cite> is used, is the option 2 that offers more possibilities. In addition, it is important to note that paraview does not include the layer of shape-&gt;radius size, i.e. faces are displayed according to the vertex centers.</p>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>Option 1: write_paraview_polyhedra</dt><dd><ul>
<li><p><cite>basedir</cite> : Name of the directory where paraview files will be written, by default this directory is named <cite>polyhedra_paraview</cite>.</p></li>
<li><p><cite>basename</cite> : Name of paraview file, there is no default name.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>YAML example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">write_paraview_polyhedra</span><span class="p">:</span>
<span class="w">   </span><span class="nt">basename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">polyhedra</span>
</pre></div>
</div>
<p>Example with 850,000 octahedra:</p>
<a class="reference internal image-reference" href="../_images/850kpolyzoom.png"><img alt="../_images/850kpolyzoom.png" src="../_images/850kpolyzoom.png" style="width: 500pt;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operator is rather limited in terms of visualization, so we now advise you to use option 2, which offers more possibilities (field display) and less memory-intensive files.</p>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>Option 2: <cite>write_paraview_generic</cite></dt><dd><ul>
<li><p><cite>binary_mode</cite> [BOOL] : paraview format file, default is true.</p></li>
<li><p><cite>compression</cite> [STRING] : level of compression, default is “default” for vtkZLibDataCompressor.</p></li>
<li><p><cite>filename</cite> [STRING]: basename of the parallel paraview output files, default is “output”.</p></li>
<li><p><cite>write_ghost</cite> [BOOL]: dump ghost particles, default is false.</p></li>
<li><p><cite>write_box</cite> [BOOL]: write box information in a box.vtp file, default is true.</p></li>
<li><p><cite>write_external_box</cite> [BOOL]: write external box (ghost area), default is false.</p></li>
<li><p>This operator is based on this function: <cite>ParaviewWriteTools::write_particles</cite>.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>YAML example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">write_paraview_generic</span><span class="p">:</span>
<span class="w">  </span><span class="nt">binary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">write_ghost</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">fields</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;vx&quot;</span><span class="p p-Indicator">,</span><span class="s">&quot;vy&quot;</span><span class="p p-Indicator">,</span><span class="s">&quot;vz&quot;</span><span class="p p-Indicator">,</span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">,</span><span class="s">&quot;orient&quot;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>How to use it with Paraview:</p>
<ul class="simple">
<li><p>Firstly, we need to load our reference mesh (Octahedron.vtk) in our case.</p></li>
<li><p>Secondly, load your particle file into the Paraview folder (default name in exaDEM for the paraview_generic operator).</p></li>
<li><p>Thirdly, choose the 3D Glyphs representation and the coloring.</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/tuto1_dump_polyhedra.png"><img alt="../_images/tuto1_dump_polyhedra.png" src="../_images/tuto1_dump_polyhedra.png" style="width: 250pt;" /></a>
<ul class="simple">
<li><p>Fourthly, in the Glyph Parameters section, choose “Orient” withi the Orientation Mode “Quaternion” and as Orientation Vectors: “orient”. To change the size, you can check Scaling and add the Scale Array you wish. Finally, in the Glyph Type dropdown menu, select “Pipeline Connection” and in Input, choose “Octahedron.vtk”.</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/tuto2_dump_polyhedra.png"><img alt="../_images/tuto2_dump_polyhedra.png" src="../_images/tuto2_dump_polyhedra.png" style="width: 250pt;" /></a>
<p>Result for a simulation of 1000 Octahedra falling in a cylinder coloried by their id:</p>
<a class="reference internal image-reference" href="../_images/tuto3_dump_polyhedra.png"><img alt="../_images/tuto3_dump_polyhedra.png" src="../_images/tuto3_dump_polyhedra.png" style="width: 500pt;" /></a>
</section>
<section id="dump-contact-network">
<h3><span class="section-number">10.3.3. </span>Dump Contact Network<a class="headerlink" href="#dump-contact-network" title="Permalink to this heading"></a></h3>
<p>This operator is used to visualize the contact network between polyhedra using ParaView. For each active contact/interaction, we assign the value of the normal force calculated in Hooke’s law.</p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>dump_contact_network</cite>:</dt><dd><ul>
<li><p><cite>basedir</cite> : Name of the directory where paraview files will be written, by default this directory is named <cite>network</cite>.</p></li>
<li><p><cite>basename</cite> : Name of paraview file, there is no default name.</p></li>
<li><p><cite>config</cite> : You can redefine HookeParameters, noting that by default, this operator reuses the ComputeHookeForce operator slot. You need to define it if you do a restart for this analysis (i.e. no simulation).</p></li>
<li><p><cite>dt</cite> : Time step of the simulation, should be already defined as config.</p></li>
<li><p><cite>timestep</cite> : Current simulation time, is defined.</p></li>
<li><p><cite>grid_interaction</cite> : List of interaction, defined by default.</p></li>
<li><p><cite>shapes_collection</cite> : Collection of shapes, filled during the call of <cite>read_shape_file</cite>.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>YAML example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">dump_contact_network</span><span class="p">:</span>
<span class="w">   </span><span class="nt">basename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">polyhedra</span>
</pre></div>
</div>
<p>Here is an example for 216 polyhedra after a fall into a cylinder, left the simulation and right the contact network:</p>
<a class="reference internal image-reference" href="../_images/contact_network_example.png"><img alt="../_images/contact_network_example.png" src="../_images/contact_network_example.png" style="width: 500pt;" /></a>
<p>Comments / Extensions:</p>
<ul class="simple">
<li><p>This operator can be modified to display more values per contact. To achieve this, you need to change the type of <cite>StorageType</cite> in the <cite>NetworkFunctor</cite> structure. Then, you’ll need to populate this function in the operator <cite>() (exaDEM::Interaction* I, const size_t offset, const size_t size)</cite>. Finally, you’ll need to add a field in write_pvtp and include this field in <cite>write_vtp</cite>.</p></li>
<li><p>Currently, this operator doesn’t take particularly long to execute and isn’t called frequently. However, it doesn’t benefit from any shared-memory parallelization (OpenMP) because the network storage is implemented using a <cite>std::map</cite>.</p></li>
</ul>
</section>
<section id="dump-interaction-data">
<h3><span class="section-number">10.3.4. </span>Dump Interaction Data<a class="headerlink" href="#dump-interaction-data" title="Permalink to this heading"></a></h3>
<p>This feature outputs the main information for each interaction. This feature has been implemented to enable post-simulation analysis.
An option has been added to the hooke_polyhedron and hooke_sphere operators to output interaction data as a csv file. To activate it, simply modify the value of <code class="docutils literal notranslate"><span class="pre">analysis_interaction_dump_frequency</span></code> in the operator block <code class="docutils literal notranslate"><span class="pre">global</span></code>.</p>
<p>Output files are located in the <cite>ExaDEMOutputDir/ExaDEMAnalysis</cite> folder. For each iteration (XXX) with file writing, a folder containing an interaction file is created, such as:  <cite>Interaction_XXX/Interaction_XXX_MPIRANK.txt</cite>.</p>
<p>For each interaction, we write:</p>
<ul class="simple">
<li><p>The particle identifier i [uint64_t],</p></li>
<li><p>The particle identifier j [uint64_t],</p></li>
<li><p>The sub-identifier of the particle i [int],</p></li>
<li><p>The sub-identifier of the particle j [int],</p></li>
<li><p>The interaction type [int &lt;= 13],</p></li>
<li><p>The contact position [Vec3d],</p></li>
<li><p>The normal force [Vec3d],</p></li>
<li><p>The tangential force [Vec3d].</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Inactive interactions have been filtered out when writing output files.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An example is available in: example/polyhedra/analyses/interaction.msp</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ExaDEM</span></code> also offers post-processing scripts for basic interaction analyses. The scripts can be used as a basis for developing other analyses according to need. The first available script is <cite>interaction_summary.py</cite> :</p>
<ul class="simple">
<li><p>Read all interaction files</p></li>
<li><p>Plot the number of interactions per types in function of the timestep (<cite>types.pdf</cite>)</p></li>
<li><p>Plot the number of interactions in function of the timestep (<cite>count.pdf</cite>)</p></li>
</ul>
<p>How to run this script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>ExaDEMOutputDir/ExaDEMAnalyses
python3<span class="w"> </span>PATH_TO_ExaDEM/scripts/post_processing/interaction_summary.py
</pre></div>
</div>
<p>Output file exemples:</p>
<p>Simulation: near 104,000 octahedral particles over 200,000 timesteps of 5.10^{-5} s falling into a cylinder.</p>
<p><a class="reference internal" href="../_images/analyses.png"><img alt="ananalyses" src="../_images/analyses.png" style="width: 500pt;" /></a></p>
<ul class="simple">
<li><p>types.pdf</p></li>
</ul>
<p><a class="reference internal" href="../_images/types.png"><img alt="antypes" src="../_images/types.png" style="width: 500pt;" /></a></p>
<ul class="simple">
<li><p>count.pdf</p></li>
</ul>
<p><a class="reference internal" href="../_images/count.png"><img alt="ancount" src="../_images/count.png" style="width: 500pt;" /></a></p>
</section>
<section id="interaction-summary">
<h3><span class="section-number">10.3.5. </span>Interaction Summary<a class="headerlink" href="#interaction-summary" title="Permalink to this heading"></a></h3>
<p>This operator allows displaying the total number of interactions, both total and active. An interaction is considered active if there is contact, and consequently, if the cumulative friction is different from Vec3d{0,0,0}. It also enables the separation of different types of interactions: Vertex-Vertex, Vertex-Edge, Vertex-Face, and Edge-Edge.</p>
<ul class="simple">
<li><p>Name: <cite>stats_interactions</cite></p></li>
<li><p>No parameter.</p></li>
<li><p>Tip: Add this operator when performing recurring but infrequent operations such as Paraview outputs or checkpoint output files (see YAML example).</p></li>
</ul>
<p>YAML example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">+dump_data_paraview</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stats_interactions</span>
</pre></div>
</div>
<p>Output example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">==================================</span>
*<span class="w"> </span>Type<span class="w"> </span>of<span class="w"> </span>interaction<span class="w">    </span>:<span class="w"> </span>active<span class="w"> </span>/<span class="w"> </span>total
*<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>interactions<span class="w"> </span>:<span class="w"> </span><span class="m">3180</span><span class="w"> </span>/<span class="w"> </span><span class="m">809086</span>
*<span class="w"> </span>Vertex<span class="w"> </span>-<span class="w"> </span>Vertex<span class="w">        </span>:<span class="w"> </span><span class="m">26</span><span class="w"> </span>/<span class="w"> </span><span class="m">4779</span>
*<span class="w"> </span>Vertex<span class="w"> </span>-<span class="w"> </span>Edge<span class="w">          </span>:<span class="w"> </span><span class="m">300</span><span class="w"> </span>/<span class="w"> </span><span class="m">188458</span>
*<span class="w"> </span>Vertex<span class="w"> </span>-<span class="w"> </span>Face<span class="w">          </span>:<span class="w"> </span><span class="m">695</span><span class="w"> </span>/<span class="w"> </span><span class="m">252612</span>
*<span class="w"> </span>Edge<span class="w">   </span>-<span class="w"> </span>Edge<span class="w">          </span>:<span class="w"> </span><span class="m">2159</span><span class="w"> </span>/<span class="w"> </span><span class="nv">363237</span>
<span class="o">==================================</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Drivers.html" class="btn btn-neutral float-left" title="9. Drivers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Parallelization.html" class="btn btn-neutral float-right" title="11. Parallelization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Thierry Carrard, Raphaël Prat, Jean-Philippe Perlat, Paul Lafourcade.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>